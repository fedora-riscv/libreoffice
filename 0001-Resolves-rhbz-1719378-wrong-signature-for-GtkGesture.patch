From 58892b7ea04a0f336cee581b073d8d4348040fa8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Caol=C3=A1n=20McNamara?= <caolanm@redhat.com>
Date: Tue, 11 Jun 2019 17:10:25 +0100
Subject: [PATCH] Resolves: rhbz#1719378 wrong signature for
 GtkGestureLongPress::pressed

Change-Id: Ib4c47189d5c9c89433f0c7de194ebb9777dc7bac
---
 vcl/inc/unx/gtk/gtkframe.hxx  |  2 +-
 vcl/unx/gtk3/gtk3gtkframe.cxx | 13 +++++--------
 2 files changed, 6 insertions(+), 9 deletions(-)

diff --git a/vcl/inc/unx/gtk/gtkframe.hxx b/vcl/inc/unx/gtk/gtkframe.hxx
index f0d2bd96bc08..084339f96d70 100644
--- a/vcl/inc/unx/gtk/gtkframe.hxx
+++ b/vcl/inc/unx/gtk/gtkframe.hxx
@@ -269,7 +269,7 @@ class GtkSalFrame : public SalFrame
                                           guint time, gpointer frame);
 
     static void         gestureSwipe(GtkGestureSwipe* gesture, gdouble velocity_x, gdouble velocity_y, gpointer frame);
-    static void         gestureLongPress(GtkGestureLongPress* gesture, gpointer frame);
+    static void         gestureLongPress(GtkGestureLongPress* gesture, gdouble x, gdouble y, gpointer frame);
 #else
     static gboolean     signalExpose( GtkWidget*, GdkEventExpose*, gpointer );
     void askForXEmbedFocus( sal_Int32 nTimecode );
diff --git a/vcl/unx/gtk3/gtk3gtkframe.cxx b/vcl/unx/gtk3/gtk3gtkframe.cxx
index c180c077bd19..888a7fb9aeb4 100644
--- a/vcl/unx/gtk3/gtk3gtkframe.cxx
+++ b/vcl/unx/gtk3/gtk3gtkframe.cxx
@@ -2739,17 +2739,14 @@ void GtkSalFrame::gestureSwipe(GtkGestureSwipe* gesture, gdouble velocity_x, gdo
     }
 }
 
-void GtkSalFrame::gestureLongPress(GtkGestureLongPress* gesture, gpointer frame)
+void GtkSalFrame::gestureLongPress(GtkGestureLongPress* gesture, gdouble x, gdouble y, gpointer frame)
 {
-    GtkSalFrame* pThis = static_cast<GtkSalFrame*>(frame);
-
-    if(pThis)
+    GdkEventSequence *sequence = gtk_gesture_single_get_current_sequence(GTK_GESTURE_SINGLE(gesture));
+    if (gtk_gesture_get_point(GTK_GESTURE(gesture), sequence, &x, &y))
     {
-        SalLongPressEvent aEvent;
+        GtkSalFrame* pThis = static_cast<GtkSalFrame*>(frame);
 
-        gdouble x, y;
-        GdkEventSequence *sequence = gtk_gesture_single_get_current_sequence(GTK_GESTURE_SINGLE(gesture));
-        gtk_gesture_get_point(GTK_GESTURE(gesture), sequence, &x, &y);
+        SalLongPressEvent aEvent;
         aEvent.mnX = x;
         aEvent.mnY = y;
 
-- 
2.20.1

