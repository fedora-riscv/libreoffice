From 4ae4c57caab02c5d8fe91cd9956fabba6bd3dc1e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Caol=C3=A1n=20McNamara?= <caolanm@redhat.com>
Date: Wed, 9 May 2012 12:39:28 +0100
Subject: [PATCH] Resolves: rhbz#805743 a11y: call doShow after we have a
 valid view

Basically a regression from ec240eafe9b25620383aa54015f5c55e0f64227a but things
were broken before that too.

enable a11y (for gnome 3 this is gsettings set org.gnome.desktop.interface
toolkit-accessibility true), and run the smoketest with dbg-util before
touching this stuff

Change-Id: I I55f4e22d8ac61c7ac3ccc37b82794604b28a8f14
---
 .../ui/slidesorter/shell/SlideSorterViewShell.cxx  |    2 +-
 sd/source/ui/toolpanel/ToolPanelViewShell.cxx      |    2 +-
 sd/source/ui/view/drviewsa.cxx                     |    3 +--
 sd/source/ui/view/outlnvsh.cxx                     |    4 ++--
 4 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/sd/source/ui/slidesorter/shell/SlideSorterViewShell.cxx b/sd/source/ui/slidesorter/shell/SlideSorterViewShell.cxx
index a9b09a9..7b874c0 100644
--- a/sd/source/ui/slidesorter/shell/SlideSorterViewShell.cxx
+++ b/sd/source/ui/slidesorter/shell/SlideSorterViewShell.cxx
@@ -186,7 +186,7 @@ void SlideSorterViewShell::Initialize (void)
         mpScrollBarBox);
     mpView = &mpSlideSorter->GetView();
 
-    ViewShell::doShow();
+    doShow();
 
     SetPool( &GetDoc()->GetPool() );
     SetUndoManager( GetDoc()->GetDocSh()->GetUndoManager() );
diff --git a/sd/source/ui/toolpanel/ToolPanelViewShell.cxx b/sd/source/ui/toolpanel/ToolPanelViewShell.cxx
index 12f6515..8eb9bc7 100644
--- a/sd/source/ui/toolpanel/ToolPanelViewShell.cxx
+++ b/sd/source/ui/toolpanel/ToolPanelViewShell.cxx
@@ -482,7 +482,7 @@ ToolPanelViewShell::ToolPanelViewShell( SfxViewFrame* pFrame, ViewShellBase& rVi
     ,mpSubShellManager()
     ,mnMenuId(0)
 {
-    ViewShell::doShow();
+    doShow();
 
     meShellType = ST_TASK_PANE;
 
diff --git a/sd/source/ui/view/drviewsa.cxx b/sd/source/ui/view/drviewsa.cxx
index 0d1b5ac..1dabda6 100644
--- a/sd/source/ui/view/drviewsa.cxx
+++ b/sd/source/ui/view/drviewsa.cxx
@@ -137,13 +137,12 @@ DrawViewShell::DrawViewShell( SfxViewFrame* pFrame, ViewShellBase& rViewShellBas
 , mbIsLayerModeActive(false)
 , mbIsInSwitchPage(false)
 {
-    ViewShell::doShow();
-
     if (pFrameViewArgument != NULL)
         mpFrameView = pFrameViewArgument;
     else
         mpFrameView = new FrameView(GetDoc());
     Construct(GetDocSh(), ePageKind);
+    doShow();
 }
 
 /*************************************************************************
diff --git a/sd/source/ui/view/outlnvsh.cxx b/sd/source/ui/view/outlnvsh.cxx
index 4f13989..f37b7a0 100644
--- a/sd/source/ui/view/outlnvsh.cxx
+++ b/sd/source/ui/view/outlnvsh.cxx
@@ -222,8 +222,6 @@ OutlineViewShell::OutlineViewShell (
       mbInitialized(false)
 
 {
-    ViewShell::doShow();
-
     if (pFrameViewArgument != NULL)
         mpFrameView = pFrameViewArgument;
     else
@@ -232,6 +230,8 @@ OutlineViewShell::OutlineViewShell (
     mpFrameView->Connect();
 
     Construct(GetDocSh());
+
+    doShow();
 }
 
 /*************************************************************************
-- 
1.7.7.6

