From 24b867c1e1d2264ff138d4eafa9791fcd1191160 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Caol=C3=A1n=20McNamara?= <caolanm@redhat.com>
Date: Mon, 26 Mar 2012 13:53:55 +0100
Subject: [PATCH] Resolves: rhbz#806663 SlideshowImpl can outlive SdModule
 (somehow)


diff --git a/sd/source/ui/slideshow/slideshowimpl.cxx b/sd/source/ui/slideshow/slideshowimpl.cxx
index 3bc8dc1..ed9d76d 100644
--- a/sd/source/ui/slideshow/slideshowimpl.cxx
+++ b/sd/source/ui/slideshow/slideshowimpl.cxx
@@ -593,7 +593,10 @@ SlideshowImpl::SlideshowImpl( const Reference< XPresentation2 >& xPresentation,
 
 SlideshowImpl::~SlideshowImpl()
 {
-    SdOptions* pOptions = SD_MOD()->GetSdOptions(DOCUMENT_TYPE_IMPRESS);
+    SdModule *pModule = SD_MOD();
+    //rhbz#806663 SlideshowImpl can outlive SdModule
+    SdOptions* pOptions = pModule ?
+        pModule->GetSdOptions(DOCUMENT_TYPE_IMPRESS) : NULL;
     if( pOptions )
     {
         pOptions->SetPresentationPenColor(mnUserPaintColor);
-- 
1.7.7.6

