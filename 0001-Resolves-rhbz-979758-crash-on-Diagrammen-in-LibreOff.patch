From 3090cfc972287da3fbdc567387527b65b3bfd128 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Caol=C3=A1n=20McNamara?= <caolanm@redhat.com>
Date: Mon, 1 Jul 2013 12:56:17 +0100
Subject: [PATCH] Resolves: rhbz#979758 crash on 'Diagrammen in LibreOffice'
 help page

Change-Id: I269846840b8e2f67838da525c020a305901cf903
---
 sw/source/core/unocore/unocrsrhelper.cxx | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/sw/source/core/unocore/unocrsrhelper.cxx b/sw/source/core/unocore/unocrsrhelper.cxx
index deeb5ba..66202c0 100644
--- a/sw/source/core/unocore/unocrsrhelper.cxx
+++ b/sw/source/core/unocore/unocrsrhelper.cxx
@@ -176,7 +176,7 @@ void GetSelectableFromAny(uno::Reference<uno::XInterface> const& xIfc,
     if (pRanges)
     {
         SwUnoCrsr const* pUnoCrsr = pRanges->GetCursor();
-        if (pUnoCrsr->GetDoc() == &rTargetDoc)
+        if (pUnoCrsr && pUnoCrsr->GetDoc() == &rTargetDoc)
         {
             o_rpPaM = lcl_createPamCopy(*pUnoCrsr);
         }
-- 
1.8.2.1

