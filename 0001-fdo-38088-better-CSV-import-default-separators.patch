From f31362eb144153c914f1ae0cdda6fe8312c1152d Mon Sep 17 00:00:00 2001
Message-Id: <f31362eb144153c914f1ae0cdda6fe8312c1152d.1334148872.git.erack@redhat.com>
From: Eike Rathke <erack@redhat.com>
Date: Wed, 4 Apr 2012 20:17:22 +0200
Subject: [PATCH] resolved fdo#38088 rhbz#810267 better CSV import default separators
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="------------erAck-patch-parts"

This is a multi-part message in MIME format.
--------------erAck-patch-parts
Content-Type: text/plain; charset=UTF-8; format=fixed
Content-Transfer-Encoding: 8bit

---
 .../registry/schema/org/openoffice/Office/Calc.xcs |    2 +-
 sc/source/ui/dbgui/scuiasciiopt.cxx                |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)


--------------erAck-patch-parts
Content-Type: text/x-patch; name="0001-fdo-33088-better-CSV-import-default-separators.patch"
Content-Transfer-Encoding: 8bit
Content-Disposition: attachment; filename="0001-fdo-33088-better-CSV-import-default-separators.patch"

diff --git a/officecfg/registry/schema/org/openoffice/Office/Calc.xcs b/officecfg/registry/schema/org/openoffice/Office/Calc.xcs
index 700d716..0cd2ff3 100644
--- a/officecfg/registry/schema/org/openoffice/Office/Calc.xcs
+++ b/officecfg/registry/schema/org/openoffice/Office/Calc.xcs
@@ -1098,7 +1098,7 @@
                         <desc>List of Separators - as a String</desc>
                         <label>Separators</label>
                     </info>
-                    <value>;    </value>
+                    <value>,;&#9;</value>
                 </prop>
                 <prop oor:name="TextSeparators" oor:type="xs:string" oor:nillable="false">
                     <info>
diff --git a/sc/source/ui/dbgui/scuiasciiopt.cxx b/sc/source/ui/dbgui/scuiasciiopt.cxx
index 93d5cfc..2a3a2b94 100644
--- a/sc/source/ui/dbgui/scuiasciiopt.cxx
+++ b/sc/source/ui/dbgui/scuiasciiopt.cxx
@@ -268,7 +268,7 @@ ScImportAsciiDlg::ScImportAsciiDlg( Window* pParent,String aDatName,
     SetText( aName );
 
     // Default options
-    OUString sFieldSeparators(RTL_CONSTASCII_USTRINGPARAM("\t"));
+    OUString sFieldSeparators(RTL_CONSTASCII_USTRINGPARAM(",;\t"));
     OUString sTextSeparators(mcTextSep);
     bool bMergeDelimiters = false;
     bool bFixedWidth = false;

--------------erAck-patch-parts--


