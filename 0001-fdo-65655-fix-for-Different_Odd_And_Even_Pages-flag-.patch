From d8a395033c7d0c924ce5898b2e9b301dbde80b44 Mon Sep 17 00:00:00 2001
From: Adam Co <rattles2013@gmail.com>
Date: Tue, 11 Jun 2013 18:21:27 +0300
Subject: [PATCH 1/3] fdo#65655 : fix for Different_Odd_And_Even_Pages flag
 ignored

Signed-off-by: Miklos Vajna <vmiklos@suse.cz>

Conflicts:
	sw/qa/extras/ooxmlexport/ooxmlexport.cxx

(cherry picked from commit db23f89b76cb61b215bcae5495eadba2b5ceace2)
Signed-off-by: Michael Stahl <mstahl@redhat.com>

Conflicts:
	sw/qa/extras/ooxmlexport/ooxmlexport.cxx

Change-Id: Icf9949bb00aa905d22aedfd8f2b297dfa89dfedb
---
 sw/qa/extras/ooxmlexport/data/fdo65655.docx       | Bin 0 -> 13760 bytes
 sw/qa/extras/ooxmlexport/ooxmlexport.cxx          |  16 ++++++++++++++++
 writerfilter/source/dmapper/DomainMapper_Impl.cxx |  10 ++++++++--
 3 files changed, 24 insertions(+), 2 deletions(-)
 create mode 100644 sw/qa/extras/ooxmlexport/data/fdo65655.docx

diff --git a/sw/qa/extras/ooxmlexport/data/fdo65655.docx b/sw/qa/extras/ooxmlexport/data/fdo65655.docx
new file mode 100644
index 0000000000000000000000000000000000000000..5fe9451bb091d59a6565bfc384b9a9d8ce6efe83
GIT binary patch
literal 13760
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
Dm4SZe

literal 0
HcmV?d00001

diff --git a/sw/qa/extras/ooxmlexport/ooxmlexport.cxx b/sw/qa/extras/ooxmlexport/ooxmlexport.cxx
index 1372151..21fa482 100644
--- a/sw/qa/extras/ooxmlexport/ooxmlexport.cxx
+++ b/sw/qa/extras/ooxmlexport/ooxmlexport.cxx
@@ -78,6 +78,7 @@ public:
     void testCp1000015();
     void testFdo70812();
     void testBnc837302();
+    void testFdo65655();
 
     CPPUNIT_TEST_SUITE(Test);
 #if !defined(MACOSX) && !defined(WNT)
@@ -140,6 +141,7 @@ void Test::run()
         {"cp1000015.odt", &Test::testCp1000015},
         {"fdo70812.docx", &Test::testFdo70812},
         {"bnc837302.docx", &Test::testBnc837302},
+        {"fdo65655.docx", &Test::testFdo65655},
     };
     // Don't test the first import of these, for some reason those tests fail
     const char* aBlacklist[] = {
@@ -813,6 +815,20 @@ void Test::testBnc837302()
     CPPUNIT_ASSERT_EQUAL(OUString(), aProperty);
 }
 
+void Test::testFdo65655()
+{
+    // The problem was that the DOCX had a non-blank odd footer and a blank even footer
+    // The 'Different Odd & Even Pages' was turned on
+    // However - LO assumed that because the 'even' footer is blank - it should ignore the 'Different Odd & Even Pages' flag
+    // So it did not import it and did not export it
+    uno::Reference<beans::XPropertySet> xPropertySet(getStyles("PageStyles")->getByName(DEFAULT_STYLE), uno::UNO_QUERY);
+    sal_Bool bValue = false;
+    xPropertySet->getPropertyValue("HeaderIsShared") >>= bValue;
+    CPPUNIT_ASSERT_EQUAL(false, bool(bValue));
+    xPropertySet->getPropertyValue("FooterIsShared") >>= bValue;
+    CPPUNIT_ASSERT_EQUAL(false, bool(bValue));
+}
+
 CPPUNIT_TEST_SUITE_REGISTRATION(Test);
 
 CPPUNIT_PLUGIN_IMPLEMENT();
diff --git a/writerfilter/source/dmapper/DomainMapper_Impl.cxx b/writerfilter/source/dmapper/DomainMapper_Impl.cxx
index 131559f..b0cde8d 100644
--- a/writerfilter/source/dmapper/DomainMapper_Impl.cxx
+++ b/writerfilter/source/dmapper/DomainMapper_Impl.cxx
@@ -1404,7 +1404,10 @@ void DomainMapper_Impl::PushPageHeader(SectionPropertyMap::PageType eType)
                     uno::makeAny(sal_True) );
             // if a left header is available then header are not shared
             bool bLeft = eType == SectionPropertyMap::PAGE_LEFT;
-            if( bLeft && m_pSettingsTable->GetEvenAndOddHeaders())
+
+            // If the 'Different Even & Odd Pages' flag is turned on - do not ignore it
+            // Even if the 'Even' header is blank - the flag should be imported (so it would look in LO like in Word)
+            if( m_pSettingsTable->GetEvenAndOddHeaders())
                 xPageStyle->setPropertyValue(rPropNameSupplier.GetName(PROP_HEADER_IS_SHARED), uno::makeAny( false ));
 
             //set the interface
@@ -1446,7 +1449,10 @@ void DomainMapper_Impl::PushPageFooter(SectionPropertyMap::PageType eType)
                     uno::makeAny(sal_True) );
             // if a left header is available then footer is not shared
             bool bLeft = eType == SectionPropertyMap::PAGE_LEFT;
-            if( bLeft && m_pSettingsTable->GetEvenAndOddHeaders())
+
+            // If the 'Different Even & Odd Pages' flag is turned on - do not ignore it
+            // Even if the 'Even' footer is blank - the flag should be imported (so it would look in LO like in Word)
+            if( m_pSettingsTable->GetEvenAndOddHeaders())
                 xPageStyle->setPropertyValue(rPropNameSupplier.GetName(PROP_FOOTER_IS_SHARED), uno::makeAny( false ));
             //set the interface
             uno::Reference< text::XText > xFooterText;
-- 
1.8.3.1

