From efd2dddb7b2e7fe2a91f0da9b5f282bf1ca9cabb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Caol=C3=A1n=20McNamara?= <caolanm@redhat.com>
Date: Fri, 9 Nov 2012 17:11:22 +0000
Subject: [PATCH] fiddle system-db test to link on RHEL-6

Change-Id: Ic256a10dd45123ae45024f4e77edd3214bc4c931
---
 configure.ac | 16 +++++++---------
 1 file changed, 7 insertions(+), 9 deletions(-)

diff --git a/configure.ac b/configure.ac
index c968dc2..307c467 100644
--- a/configure.in
+++ b/configure.in
@@ -7491,15 +7491,13 @@ if test "$with_system_db" = "yes"; then
     SYSTEM_DB_CFLAGS="-DSYSTEM_DB_HEADER='<$db_header>'"
 
     DB_LIB=
-    dnl At least on OpenBSD dbver is not appended to the library
-    if test "$_os" = "OpenBSD"; then
-        dbver=''
-    fi
-    for dash in - ''; do
-        AC_CHECK_LIB(db$dash$dbver, dbopen,
-            [ DB_LIB="db$dash$dbver"; DB_CPPLIB="db_cxx$dash$dbver"; break ])
-        AC_CHECK_LIB(db$dash$dbver, __db185_open,
-            [ DB_LIB="db$dash$dbver"; DB_CPPLIB="db_cxx$dash$dbver"; break ])
+    dnl At least on OpenBSD and RHEL-6 dbver is not appended to the library
+    dnl even though the headers are in a versioned dir
+    for suffix in '' '-$dbver' '$dbver' ''; do
+        AC_CHECK_LIB(db$suffix, dbopen,
+            [ DB_LIB="db$suffix"; DB_CPPLIB="db_cxx$suffix"; break ])
+        AC_CHECK_LIB(db$suffix, __db185_open,
+            [ DB_LIB="db$suffix"; DB_CPPLIB="db_cxx$suffix"; break ])
     done
 
     if test -z "$DB_LIB"; then
-- 
1.7.11.7

