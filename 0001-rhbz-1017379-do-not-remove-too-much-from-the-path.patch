From 5b35f21f1c69239d0605b0751bed87a410fbffee Mon Sep 17 00:00:00 2001
From: David Tardon <dtardon@redhat.com>
Date: Thu, 6 Feb 2014 13:49:05 +0100
Subject: [PATCH] rhbz#1017379 do not remove too much from the path

Change-Id: Ibffa7f2fbe91be9b95217ce36999e286ef444a37
---
 oox/source/ppt/timenodelistcontext.cxx | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/oox/source/ppt/timenodelistcontext.cxx b/oox/source/ppt/timenodelistcontext.cxx
index 7a9c3c7..aaeacb8 100644
--- a/oox/source/ppt/timenodelistcontext.cxx
+++ b/oox/source/ppt/timenodelistcontext.cxx
@@ -785,7 +785,10 @@ namespace oox { namespace ppt {
                 }
 
                 OUString aStr = xAttribs->getOptionalValue( XML_path );
-                aStr = aStr.replace( 'E', ' ' );
+                // E can appear inside a number, so we only check for its presence at the end
+                aStr = aStr.trim();
+                if (aStr.endsWith("E"))
+                    aStr = aStr.copy(0, aStr.getLength() - 1);
                 aStr = aStr.trim();
                 pNode->getNodeProperties()[ NP_PATH ] = makeAny(aStr);
                 mnPathEditMode = xAttribs->getOptionalValueToken( XML_pathEditMode, 0 );
-- 
1.8.4.2

