From 12d52250462435b19d1873af7bd064d3e64b1c4c Mon Sep 17 00:00:00 2001
From: David Tardon <dtardon@redhat.com>
Date: Sun, 25 May 2014 13:19:31 +0200
Subject: [PATCH 5/9] always provide REDLAND_CFLAGS/LIBS to ext. projects

Change-Id: Iad1004503e91fbaf6251edc50b20d89ddbb15efa
---
 RepositoryExternal.mk | 6 +++---
 configure.ac          | 6 +++++-
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/RepositoryExternal.mk b/RepositoryExternal.mk
index 920436a..2ecd404 100644
--- a/RepositoryExternal.mk
+++ b/RepositoryExternal.mk
@@ -1784,7 +1784,7 @@ $(eval $(call gb_Helper_register_libraries_for_install,PLAINLIBS_OOO,ooo,\
 
 define gb_LinkTarget__use_revenge
 $(call gb_LinkTarget_set_include,$(1),\
-	-I$(call gb_UnpackedTarball_get_dir,librevenge)/inc \
+	$(REVENGE_CFLAGS) \
 	$$(INCLUDE) \
 )
 $(call gb_LinkTarget_use_libraries,$(1),\
@@ -1808,11 +1808,11 @@ define gb_LinkTarget__use_revenge
 $(call gb_LinkTarget_use_package,$(1),librevenge)
 
 $(call gb_LinkTarget_set_include,$(1),\
-	-I$(call gb_UnpackedTarball_get_dir,librevenge)/inc \
+	$(REVENGE_CFLAGS) \
 	$$(INCLUDE) \
 )
 $(call gb_LinkTarget_add_libs,$(1),\
-	-L$(call gb_UnpackedTarball_get_dir,librevenge)/src/lib/.libs -lrevenge-0.0 \
+	$(REVENGE_LIBS) \
 )
 endef
 
diff --git a/configure.ac b/configure.ac
index ad27916..5adefd8 100644
--- a/configure.ac
+++ b/configure.ac
@@ -7665,7 +7665,11 @@ AC_SUBST([ENABLE_EOT])
 dnl ===================================================================
 dnl Check for system librevenge
 dnl ===================================================================
-libo_CHECK_SYSTEM_MODULE([librevenge],[REVENGE],[librevenge-0.0])
+AS_IF([test "$COM" = "MSC"],
+      [librevenge_libdir="${WORKDIR}/LinkTarget/Library"],
+      [librevenge_libdir="${WORKDIR}/UnpackedTarball/lirevenge/src/lib/.libs"]
+)
+libo_CHECK_SYSTEM_MODULE([librevenge],[REVENGE],[librevenge-0.0],["-I${WORKDIR}/UnpackedTarball/librevenge/inc"],["-L${librevenge_libdir} -lrevenge-0.0"]),
 
 dnl ===================================================================
 dnl Check for system libe-book
-- 
1.9.3

