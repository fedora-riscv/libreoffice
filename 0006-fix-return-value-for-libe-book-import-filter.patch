From eab69b534b5fdfcd520fd5832aa2d184bba2fa26 Mon Sep 17 00:00:00 2001
From: David Tardon <dtardon@redhat.com>
Date: Thu, 29 May 2014 13:03:31 +0200
Subject: [PATCH 06/18] fix return value for libe-book import filter

Change-Id: Idd84489a3123d506166a24ff5c85a4e7f75ee676
(cherry picked from commit 5fde8e38c127a872a66b8029b69aff55b01d6d88)
---
 writerperfect/source/writer/EBookImportFilter.cxx | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)

diff --git a/writerperfect/source/writer/EBookImportFilter.cxx b/writerperfect/source/writer/EBookImportFilter.cxx
index 3003768..efe5334 100644
--- a/writerperfect/source/writer/EBookImportFilter.cxx
+++ b/writerperfect/source/writer/EBookImportFilter.cxx
@@ -28,18 +28,23 @@ using libebook::EBOOKDocument;
 
 bool EBookImportFilter::doImportDocument( librevenge::RVNGInputStream &rInput, const rtl::OUString &rFilterName, librevenge::RVNGTextInterface &rGenerator )
 {
+    EBOOKDocument::Type type = EBOOKDocument::TYPE_UNKNOWN;
+
     if (rFilterName == "FictionBook 2")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_FICTIONBOOK2);
+        type = EBOOKDocument::TYPE_FICTIONBOOK2;
     else if (rFilterName == "PalmDoc")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_PALMDOC);
+        type = EBOOKDocument::TYPE_PALMDOC;
     else if (rFilterName == "Plucker eBook")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_PLUCKER);
+        type = EBOOKDocument::TYPE_PLUCKER;
     else if (rFilterName == "eReader eBook")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_PEANUTPRESS);
+        type = EBOOKDocument::TYPE_PEANUTPRESS;
     else if (rFilterName == "TealDoc")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_TEALDOC);
+        type = EBOOKDocument::TYPE_TEALDOC;
     else if (rFilterName == "zTXT")
-        return EBOOKDocument::parse(&rInput, &rGenerator, EBOOKDocument::TYPE_ZTXT);
+        type = EBOOKDocument::TYPE_ZTXT;
+
+    if (EBOOKDocument::TYPE_UNKNOWN != type)
+        return EBOOKDocument::RESULT_OK == EBOOKDocument::parse(&rInput, &rGenerator, type);
 
     return false;
 }
-- 
1.9.3

