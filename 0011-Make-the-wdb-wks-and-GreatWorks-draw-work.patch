From 0dca001fd4cb1397137ae0e217950494bb86d6c8 Mon Sep 17 00:00:00 2001
From: osnola <alonso@loria.fr>
Date: Thu, 29 May 2014 14:29:45 +0200
Subject: [PATCH 11/18] Make the wdb/wks and GreatWorks(draw) work

Change-Id: I1a736a511e6007a4ed6413eb8d9b8e364d73f765
(cherry picked from commit eccfc72781dfa485c94b251e81718bdddd544606)
---
 filter/source/config/fragments/filters/Great_Works_Draw.xcu     | 2 +-
 filter/source/config/fragments/types/calc_MS_Works_Document.xcu | 4 ++--
 postprocess/Rdb_services.mk                                     | 1 +
 3 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/filter/source/config/fragments/filters/Great_Works_Draw.xcu b/filter/source/config/fragments/filters/Great_Works_Draw.xcu
index 4bb0667..8153102 100644
--- a/filter/source/config/fragments/filters/Great_Works_Draw.xcu
+++ b/filter/source/config/fragments/filters/Great_Works_Draw.xcu
@@ -12,7 +12,7 @@
         <value>IMPORT ALIEN USESOPTIONS 3RDPARTYFILTER PREFERRED</value>
     </prop>
     <prop oor:name="FilterService">
-        <value>com.sun.star.comp.Draaw.MWAWDrawImportFilter</value>
+        <value>com.sun.star.comp.Draw.MWAWDrawImportFilter</value>
     </prop>
     <prop oor:name="UIName">
         <value xml:lang="en-US">GreatWorks Document</value>
diff --git a/filter/source/config/fragments/types/calc_MS_Works_Document.xcu b/filter/source/config/fragments/types/calc_MS_Works_Document.xcu
index d409be8..8785a32 100644
--- a/filter/source/config/fragments/types/calc_MS_Works_Document.xcu
+++ b/filter/source/config/fragments/types/calc_MS_Works_Document.xcu
@@ -18,8 +18,8 @@
     <node oor:name="calc_MS_Works_Document" oor:op="replace" >
         <prop oor:name="DetectService"><value>com.sun.star.comp.Calc.MSWorksCalcImportFilter</value></prop>
         <prop oor:name="URLPattern"/>
-        <prop oor:name="Extensions"><value>wps</value></prop>
-        <prop oor:name="MediaType"><value>application/vnd.ms-works</value></prop>
+        <prop oor:name="Extensions"><value>wks/wdb</value></prop>
+        <prop oor:name="MediaType"></prop>
         <prop oor:name="Preferred"><value>true</value></prop>
         <prop oor:name="PreferredFilter"><value>MS_Works_Calc</value></prop>
         <prop oor:name="UIName">
diff --git a/postprocess/Rdb_services.mk b/postprocess/Rdb_services.mk
index 9ebe6d2..a1fe9bc 100644
--- a/postprocess/Rdb_services.mk
+++ b/postprocess/Rdb_services.mk
@@ -120,6 +120,7 @@ $(eval $(call gb_Rdb_add_components,services,\
 	writerperfect/source/draw/wpftdraw \
 	writerperfect/source/impress/wpftimpress \
 	writerperfect/source/writer/wpftwriter \
+	writerperfect/source/calc/wpftcalc \
 	$(if $(filter MACOSX,$(OS)), \
 		$(if $(filter 1060,$(MACOSX_SDK_VERSION)),, \
 			$(call gb_Helper_optional,AVMEDIA,avmedia/source/macavf/avmediaMacAVF) \
-- 
1.9.3

